package edu.kit.ipd.sdq.kamp4attack.tests.change.vulnerability.scalability;

import org.eclipse.emf.common.util.EList;
import org.eclipse.emf.common.util.EMap;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.attackSpecification.Vulnerability;
import org.palladiosimulator.pcm.resourceenvironment.ResourceContainer;
import org.palladiosimulator.pcm.resourceenvironment.ResourceEnvironment;
import org.palladiosimulator.pcm.resourceenvironment.ResourceenvironmentFactory;

public abstract class PooledResources extends ScalabilityTests {

    @Override
    protected String getFilename() {
        return "pool.csv";
    }

    @Override
    protected ResourceContainer resourceAddOperation(ResourceEnvironment environment, ResourceContainer origin,
            EMap<ResourceContainer, EList<Vulnerability>> integration, EList<Vulnerability> vulnerability) {
        var linking = environment.getLinkingResources__ResourceEnvironment().get(0);
        var resource = ResourceenvironmentFactory.eINSTANCE.createResourceContainer();

        linking.getConnectedResourceContainers_LinkingResource().add(resource);

       integration.put(resource, vulnerability);

        environment.getResourceContainer_ResourceEnvironment().add(resource);

        return resource;
    }

}
